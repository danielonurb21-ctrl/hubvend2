{"cacheVersion":6,"page":{"id":"eb3a0637-1e44-4187-80ff-d0ffcfb0b058","paths":{"pt":"qr-code","default":"qr-code"},"cmsDataSetPath":null,"workflows":[{"id":"c856eb64-5f2c-4afd-8db7-1a735c8bd030","name":"Fetch QR Code on Page Load","actions":{"error_1":{"id":"error_1","name":"Log error","next":null,"type":"log","level":"error","message":"Error fetching QR code","preview":{"code":"context.error","__wwtype":"f"},"__wwdescription":""},"action_1":{"id":"action_1","name":"Check if QR Code URL is empty","next":null,"type":"if","value":{"code":"return !variables['0e14f1b9-3e29-40f6-bd1c-7eecea6bf3f4'] || variables['0e14f1b9-3e29-40f6-bd1c-7eecea6bf3f4'].trim() === ''","__wwtype":"js"},"branches":[{"id":"action_2","value":true},{"id":"action_6","value":false}],"description":"Check if v_qrCodeUrl is empty to avoid unnecessary API calls","__wwdescription":"Check if v_qrCodeUrl is empty to avoid unnecessary API calls"},"action_2":{"id":"action_2","name":"Log fetching QR code","next":"action_3","type":"log","level":"info","message":"QR Code URL is empty, fetching from API...","__wwdescription":""},"action_3":{"id":"action_3","args":{"url":"https://webhook.exittodigital.com.br/webhook/get-qrcode","method":"GET","headers":[{"key":"Content-Type","value":"application/json"}],"queries":[{"key":"client_id","value":{"code":"collections['b9557e81-7047-4d5d-8b6a-0a6b7fe3de67']?.['data']?.[0]?.['id']","filter":{"link":"$and","conditions":[{"field":"id","value":"","operator":"$iLike:contains"}]},"__wwtype":"f"}}],"dataType":"json","isThroughServer":true},"name":"Fetch QR Code from API","next":"action_4","type":"2bd1c688-31c5-443e-ae25-59aa5b6431fb-apiRequest","description":"Make GET request to the n8n webhook endpoint","__wwdescription":"Make GET request to the n8n webhook endpoint"},"action_4":{"id":"action_4","code":"// Captura o objeto 'data' da resposta da a√ß√£o 3\nconst apiResponse = context.workflow['action_3'].result.data;\n\n// Se o status for \"waiting\" mas o qrcode ainda for nulo, retornamos null em vez de erro\nif (apiResponse && apiResponse.status === \"waiting\" && !apiResponse.qrcode) {\n    return null; \n}\n\n// Se o status for \"open\", o cliente j√° est√° conectado\nif (apiResponse && (apiResponse.status === \"open\" || apiResponse.status === \"connected\")) {\n    return \"connected\";\n}\n\n// Verifica se o qrcode existe e extrai a string\nif (apiResponse && apiResponse.qrcode) {\n    let base64 = apiResponse.qrcode;\n    \n    // Remove o prefixo se ele existir para evitar erros na convers√£o do WeWeb\n    if (base64.startsWith('data:image')) {\n        base64 = base64.split(',')[1];\n    }\n    \n    return base64;\n}\n\n// Apenas cai aqui se a resposta for realmente inv√°lida ou erro de rede\nthrow new Error(\"Resposta inv√°lida da API\");","name":"Process API response","next":"action_5","type":"custom-js","description":"Extract base64 string from response and format it properly","__wwdescription":"Extract base64 string from response and format it properly"},"action_5":{"id":"action_5","name":"Convert base64 to URL","next":"action_7","type":"file-create-url","fileString":{"code":"context.workflow['action_4'].result","__wwtype":"f"},"description":"Convert base64 to Blob URL using WeWeb utility function","__wwdescription":"Convert base64 to Blob URL using WeWeb utility function"},"action_6":{"id":"action_6","name":"Log QR Code exists","next":null,"type":"log","level":"info","message":"QR Code URL already exists, skipping API call","__wwdescription":""},"action_7":{"id":"action_7","name":"Update QR Code URL","next":"action_8","type":"variable","varId":"0e14f1b9-3e29-40f6-bd1c-7eecea6bf3f4","varValue":{"code":"context.workflow['action_5'].result","__wwtype":"f"},"description":"Update the v_qrCodeUrl variable with the generated URL","__wwdescription":"Update the v_qrCodeUrl variable with the generated URL"},"action_8":{"id":"action_8","name":"Log success","next":null,"type":"log","level":"info","message":"QR Code URL updated successfully","preview":{"code":"variables['0e14f1b9-3e29-40f6-bd1c-7eecea6bf3f4']","__wwtype":"f"},"__wwdescription":""}},"trigger":"onload","description":"This script will run when the page loads. It checks if the v_qrCodeUrl variable is empty, and if so, makes a GET request to the webhook.exittodigital.com.br API to fetch the QR code. It then converts the base64 response to a URL and updates the v_qrCodeUrl variable with this URL.","firstAction":"action_1","firstErrorAction":"error_1"}]},"sections":{"ec175fea-9eb2-4143-9dc8-fddebd4d0949":{"uid":"ec175fea-9eb2-4143-9dc8-fddebd4d0949","linkId":"1afeda47-30e0-4125-9380-1833ec90faef","_state":{"style":{"default":{}}},"content":{"default":{"wwObjects":[{"uid":"dfba9225-7d19-4392-84df-e264dc115450","isWwObject":true},{"uid":"3becf2e8-7c1b-4671-abf4-c2024d6f6d02","isWwObject":true},{"uid":"73be38b8-92d7-47cc-8505-0a7fc2dea1e8","isWwObject":true},{"uid":"0bb13aa8-519d-4fdb-8b9b-03a5adaeaf37","isWwObject":true},{"uid":"85a6ee43-5dd9-45aa-a84a-9fd9098fc69c","isWwObject":true}],"_ww-layout_alignItems":"flex-start","_ww-layout_flexDirection":"column"}},"sectionBaseId":"99586bd3-2b15-4d6b-a025-6a50d07ca845","sectionTitle":"Section"}},"wwObjects":{"3daa170a-8aa5-4241-9021-853a17443afa":{"uid":"3daa170a-8aa5-4241-9021-853a17443afa","_state":{"style":{"default":{"width":"20px","margin":"0 6px 0 0"}}},"content":{"default":{"icon":"lucide/plus","color":"#FFFFFF"}},"name":null,"wwObjectBaseId":"1b1e2173-9b78-42cc-a8ee-a6167caea340","libraryComponentBaseId":null,"parentSectionId":"ec175fea-9eb2-4143-9dc8-fddebd4d0949"},"8de360ed-b01e-41e0-9260-0bb802aaac0b":{"uid":"8de360ed-b01e-41e0-9260-0bb802aaac0b","_state":{"style":{"default":{"width":"20px","margin":"0 0 0 6px"}}},"content":{"default":{"icon":"lucide/plus","color":"#FFFFFF"}},"name":null,"wwObjectBaseId":"1b1e2173-9b78-42cc-a8ee-a6167caea340","libraryComponentBaseId":null,"parentSectionId":"ec175fea-9eb2-4143-9dc8-fddebd4d0949"},"85a6ee43-5dd9-45aa-a84a-9fd9098fc69c":{"uid":"85a6ee43-5dd9-45aa-a84a-9fd9098fc69c","_state":{"style":{"default":{"align":"center","border":"none","cursor":"pointer","padding":"12px 24px","boxShadow":"0 2px 4px rgba(0,0,0,0.1)","transition":"all 0.2s ease","borderRadius":"8px","backgroundColor":"#3b82f6"},"_wwHover_default":{"boxShadow":"0 4px 6px rgba(0,0,0,0.1)","transform":"translateY(-1px)","backgroundColor":"#2563eb"}},"states":[{"id":"_wwHover","label":"hover"}],"interactions":[{"id":"dd0839a0-95f5-46ce-963e-6c99cfd92e40","name":"clique Reload","actions":{"5c9770d3-b028-4734-bb40-d8b8a1b333a4":{"id":"5c9770d3-b028-4734-bb40-d8b8a1b333a4","next":"d92d4b0a-ee79-4885-944e-a15d0dabe611","type":"variable","varId":"b405549c-89d3-4fcc-8098-94d5d732fccc","internal":false,"varValue":""},"d92d4b0a-ee79-4885-944e-a15d0dabe611":{"id":"d92d4b0a-ee79-4885-944e-a15d0dabe611","args":{"url":"https://webhook.exittodigital.com.br/webhook/get-qrcode","method":"GET","queries":[{"key":"client_id","value":"11"}],"isThroughServer":true},"type":"2bd1c688-31c5-443e-ae25-59aa5b6431fb-apiRequest"}},"trigger":"click","firstAction":"5c9770d3-b028-4734-bb40-d8b8a1b333a4","triggerConditions":null}]},"content":{"default":{"text":"New text","disabled":false,"leftIcon":{"uid":"3daa170a-8aa5-4241-9021-853a17443afa","isWwObject":true},"rightIcon":{"uid":"8de360ed-b01e-41e0-9260-0bb802aaac0b","isWwObject":true},"buttonType":"button","hasLeftIcon":false,"hasRightIcon":false,"_ww-text_text":{"0":"N","1":"e","2":"w","3":" ","4":"t","5":"e","6":"x","7":"t","en":"<div>Click</div>","pt":"<div>Recarregar QR code</div>"},"_ww-text_color":"#ffffff","_ww-text_fontSize":"16px","_ww-text_fontWeight":"500"}},"name":"Button","wwObjectBaseId":"59dca300-db78-42e4-a7a6-0cbf22d3cc82","libraryComponentBaseId":null,"parentSectionId":"ec175fea-9eb2-4143-9dc8-fddebd4d0949"},"dfba9225-7d19-4392-84df-e264dc115450":{"uid":"dfba9225-7d19-4392-84df-e264dc115450","_state":{"style":{"default":{"align":"center","margin":"30px 0 0px 0"}}},"content":{"tablet":{},"default":{"tag":"p","bgColor":"","shadows":"","fontStyle":"ww-font-style-text","textColor":"","globalStyle":{},"_ww-text_text":{"en":"<p>This is some text</p>","pt":"<div>üì± Conecte ao whatsapp</div>"},"transformation":"","_ww-text_ellipsis":false,"_ww-text_fontSize":"16px","_ww-text_sanitize":false}},"name":"Text","wwObjectBaseId":"d7904e9d-fc9a-4d80-9e32-728e097879ad","libraryComponentBaseId":null,"parentSectionId":"ec175fea-9eb2-4143-9dc8-fddebd4d0949"},"3becf2e8-7c1b-4671-abf4-c2024d6f6d02":{"uid":"3becf2e8-7c1b-4671-abf4-c2024d6f6d02","_state":{"style":{"default":{"align":"center","width":"300px","height":"unset","margin":"50px","aspectRatio":1}}},"content":{"default":{"alt":{"en":""},"url":{"code":"variables['0e14f1b9-3e29-40f6-bd1c-7eecea6bf3f4']","__wwtype":"f","defaultValue":"https://cdn.weweb.app/public/images/no_image_selected.png"},"loading":"lazy","overlay":"linear-gradient(undefineddeg)","objectFit":null}},"name":"Image","wwObjectBaseId":"3a7d6379-12d3-4387-98ff-b332bb492a63","libraryComponentBaseId":null,"parentSectionId":"ec175fea-9eb2-4143-9dc8-fddebd4d0949"},"0bb13aa8-519d-4fdb-8b9b-03a5adaeaf37":{"uid":"0bb13aa8-519d-4fdb-8b9b-03a5adaeaf37","_state":{"style":{"default":{"align":"center","margin":"30px 0 0px 0"}}},"content":{"tablet":{},"default":{"tag":"p","bgColor":"","shadows":"","fontStyle":"ww-font-style-text","textColor":"","globalStyle":{},"_ww-text_text":{"en":"<p>This is some text</p>","pt":"<div><br></div>"},"transformation":"","_ww-text_ellipsis":false,"_ww-text_fontSize":"16px","_ww-text_sanitize":false}},"name":"Text","wwObjectBaseId":"d7904e9d-fc9a-4d80-9e32-728e097879ad","libraryComponentBaseId":null,"parentSectionId":"ec175fea-9eb2-4143-9dc8-fddebd4d0949"},"73be38b8-92d7-47cc-8505-0a7fc2dea1e8":{"uid":"73be38b8-92d7-47cc-8505-0a7fc2dea1e8","_state":{"style":{"default":{"align":"center","margin":"20px","textAlign":"center"}}},"content":{"tablet":{},"default":{"tag":"p","bgColor":"","shadows":"","fontStyle":"ww-font-style-text","textColor":"","globalStyle":{},"_ww-text_text":{"en":"<p>This is some text</p>","pt":"<div>1. Abra o WhatsApp no seu celular</div><div>2. Toque em Mais op√ß√µes &gt; Dispositivos conectados</div><div>3. Toque em Conectar um dispositivo</div><div>4. Aponte seu celular para esta tela para escanear o c√≥digo  </div><div>5. Se o QR code n√£o aparecer √© porque j√° est√° conectado</div>"},"transformation":"","_ww-text_ellipsis":false,"_ww-text_fontSize":"16px","_ww-text_sanitize":false,"_ww-text_textAlign":"center"}},"name":"Text","wwObjectBaseId":"d7904e9d-fc9a-4d80-9e32-728e097879ad","libraryComponentBaseId":null,"parentSectionId":"ec175fea-9eb2-4143-9dc8-fddebd4d0949"}},"collections":[{"id":"b9557e81-7047-4d5d-8b6a-0a6b7fe3de67","designId":"86f88cb3-1e85-4481-802e-f8faa51f5e47","settingsId":"f9dc4d78-cb41-4dea-bbb7-2bfee076deb7","pluginId":"f9ef41c3-1c53-4857-855b-f2f6a40b7186","type":"single","name":"Perfil Cliente","displayBy":null,"lastSyncDate":null,"config":{"table":"clients","dataFields":["id","nome_completo","nome_empresa","email","whatsapp_numero","instance_name","api_key","status_conta","limite_diario","meta_do_dia","faturamento_total","total_leads_convertidos","created_at"],"fieldsMode":"guided","isAutoFetch":true,"primaryData":["id"],"isPersistentOnNav":true,"dataFieldsAdvanced":""},"error":null,"limit":null,"mode":"dynamic","filter":[],"sort":[],"isSyncing":false,"needSync":false,"fields":{},"folder":null,"description":null,"createdAt":"2025-12-18T15:06:46.768Z","updatedAt":"2025-12-30T13:30:25.877Z","data":{}}],"variables":[{"id":"0e14f1b9-3e29-40f6-bd1c-7eecea6bf3f4","type":"string","name":"v_qrCodeUrl","defaultValue":"","isLocalStorage":false,"isPersistentOnNav":false},{"id":"b405549c-89d3-4fcc-8098-94d5d732fccc","type":"string","name":"v_qrcode","defaultValue":"","isLocalStorage":false,"isPersistentOnNav":false}],"workflows":[],"formulas":[],"libraryComponents":[]}